var PackageAutoUpdateBlacklist=Class.create({initialize:function(i,e){this.list=i,this.data=e,this.initializeButtons(),this.initializeListElements()},initializeButtons:function(){this.initializeAllPackagesCheckbox();for(var i=0,e=this.list.length;e>i;i++){var t=this.list[i];this.initializePackageCheckbox(t),this.initializePackageBlacklist(t),this.initializePackageBlacklistAddSelect(t),this.initializePackageBlacklistAddButton(t),this.initializePackageBlacklistRemoveButton(t)}},initializeAllPackagesCheckbox:function(){$("allPackagesCheckbox").onclick=function(){for(var i=0,e=packageAutoUpdateBlacklist.list.length;e>i;i++){var t=packageAutoUpdateBlacklist.list[i],a=$("version-"+t+"Checkbox");a.disabled?a.checked=!1:this.checked?a.checked||a.click():a.checked&&a.click()}}},initializePackageCheckbox:function(i){$("version-"+i+"Checkbox").onclick=function(){var i=this.id.substring(8,this.id.length-8);if(enableFormElements($("version-"+i+"Div"),this.checked),this.checked)new Effect.Appear($("version-"+i+"Blacklist"),{duration:.5});else{new Effect.Fade($("version-"+i+"Blacklist"),{duration:.5});var e=$("version-"+i+"BlacklistDiv");e.visible()&&new Effect.BlindUp(e,{duration:.5})}}},initializePackageBlacklist:function(i){$("version-"+i+"Blacklist").onclick=function(){var i=$(this.id+"Div");i.visible()?new Effect.BlindUp(i,{duration:.5}):new Effect.BlindDown(i,{duration:.5})}},initializePackageBlacklistAddSelect:function(i){$("version-"+i+"BlacklistAddSelect").onchange=function(){var i=this.id.substring(8,this.id.length-18),e=$("version-"+i+"BlacklistAddInput");0!=this.selectedIndex&&(e.value=this.value,this.selectedIndex=0)}},initializePackageBlacklistAddButton:function(i){$("version-"+i+"BlacklistAdd").onclick=function(){var i=this.id.substring(8,this.id.length-12),e=$(this.id+"Input").value;if(""==e)return packageAutoUpdateBlacklist.showError(this.id,language["wcf.global.error.empty"]),void 0;var t=e.indexOf("*");return-1!=t&&t!=e.length-1||"*"==e?(packageAutoUpdateBlacklist.showError(this.id,language["wcf.acp.packageUpdate.blacklist.add.wildcardError"]),void 0):(new Ajax.Request("index.php?action=PackageUpdateBlacklistAdd"+SID_ARG_2ND,{method:"post",parameters:{packageID:i,"versions[]":packageAutoUpdateBlacklist.data[i].versions,blacklistPackageVersion:e},onSuccess:function(i){var e=i.responseText.evalJSON();for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(packageAutoUpdateBlacklist.data[t]=e[t]);packageAutoUpdateBlacklist.initializeListElements(),packageAutoUpdateBlacklist.showSuccess(this.id)}.bind(this),onFailure:function(){packageAutoUpdateBlacklist.showError(this.id,language["wcf.acp.packageUpdate.blacklist.add.error"])}.bind(this)}),void 0)}},initializePackageBlacklistRemoveButton:function(i){$("version-"+i+"BlacklistRemove").onclick=function(){var i=this.id.substring(8,this.id.length-15),e=$(this.id+"Select").value;new Ajax.Request("index.php?action=PackageUpdateBlacklistRemove"+SID_ARG_2ND,{method:"post",parameters:{packageID:i,"versions[]":packageAutoUpdateBlacklist.data[i].versions,blacklistPackageVersion:e},onSuccess:function(i){var e=i.responseText.evalJSON();for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(packageAutoUpdateBlacklist.data[t]=e[t]);packageAutoUpdateBlacklist.initializeListElements(),packageAutoUpdateBlacklist.showSuccess(this.id)}.bind(this),onFailure:function(){packageAutoUpdateBlacklist.showError(this.id,language["wcf.acp.packageUpdate.blacklist.remove.error"])}.bind(this)})}},initializeListElements:function(){for(var i=0,e=this.list.length;e>i;i++){var t=this.list[i];this.initializeVersionListElement(t),this.initializeBlacklistAddElement(t),this.initializeBlacklistRemoveElement(t)}},initializeVersionListElement:function(i){var e=$("version-"+i+"Div"),t=$("version-"+i+"Checkbox"),a=$("version-"+i);if(this.removeVersionOptionElements(a),this.data[i].notBlacklistedVersions.length>0)this.addVersionOptionElements(a,this.data[i].notBlacklistedVersions),a.selectedIndex=this.data[i].notBlacklistedVersions.length-1,e.visible()||new Effect.BlindDown(e,{duration:.5}),t.disabled&&(t.disabled=!1,t.checked=!0);else{e.visible()&&new Effect.BlindUp(e,{duration:.5}),t.disabled=!0,t.checked=!1;var n=$("version-"+i+"BlacklistDiv");n.visible()||new Effect.BlindDown(n,{duration:.5})}},initializeBlacklistAddElement:function(i){var e=$("version-"+i+"BlacklistAddSelect");this.removeVersionOptionElements(e),this.addVersionOptionElement(e,""),this.data[i].notBlacklistedVersions.length>0?(this.addVersionOptionElements(e,this.data[i].notBlacklistedVersions),e.visible()||new Effect.BlindDown(e,{duration:.5})):e.visible()&&new Effect.BlindUp(e,{duration:.5})},initializeBlacklistRemoveElement:function(i){var e=$("version-"+i+"BlacklistRemoveDiv"),t=$("version-"+i+"BlacklistRemoveSelect");this.removeVersionOptionElements(t),this.data[i].blacklist.length>0?(this.addVersionOptionElements(t,this.data[i].blacklist),e.visible()||new Effect.BlindDown(e,{duration:.5})):e.visible()&&new Effect.BlindUp(e,{duration:.5})},addVersionOptionElements:function(i,e){for(var t=0,a=e.length;a>t;t++)this.addVersionOptionElement(i,e[t])},addVersionOptionElement:function(i,e){var t=document.createElement("option");t.text=e,t.value=e,i.add(t,null)},removeVersionOptionElements:function(i){for(var e=0,t=i.childNodes.length;t>e;e++)i.removeChild(i.firstChild)},showSuccess:function(i){this.hideError(i),new Effect.Appear($(i+"Success"),{duration:.5}),window.setTimeout("if($('"+i+"Success').visible()) new Effect.Fade($('"+i+"Success'), { duration: 0.5 })",5e3)},hideSuccess:function(i){var e=$(i+"Success");e.visible()&&new Effect.Fade(e,{duration:.5})},showError:function(i,e){this.hideSuccess(i),$(i+"Div").addClassName("formError");var t=$(i+"Error");t.replaceChild(document.createTextNode(e),t.firstChild),t.visible()?new Effect.Pulsate(t,{duration:.5,pulses:3}):new Effect.BlindDown(t,{duration:.5})},hideError:function(i){$(i+"Div").removeClassName("formError");var e=$(i+"Error");e.visible()&&new Effect.BlindUp(e,{duration:.5})}});